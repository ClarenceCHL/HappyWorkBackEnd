2025-04-16 10:58:11,335 - INFO - 开始数据库迁移...
2025-04-16 10:58:11,340 - INFO - 添加last_activity字段到chats表...
2025-04-16 10:58:11,341 - ERROR - 迁移出错: no such column: m.chat_id
2025-04-16 10:58:11,341 - ERROR - 数据库迁移失败: no such column: m.chat_id
2025-04-16 10:58:30,395 - INFO - 开始数据库迁移...
2025-04-16 10:58:30,396 - INFO - 添加last_activity字段到chats表...
2025-04-16 10:58:30,398 - INFO - 已更新 0 个聊天的last_activity字段
2025-04-16 10:58:30,398 - INFO - 重命名消息表的外键字段从conversation_id到chat_id...
2025-04-16 10:58:30,399 - INFO - 消息表的外键已成功重命名
2025-04-16 10:58:30,399 - INFO - 数据库迁移成功完成
2025-04-16 10:58:30,399 - INFO - 数据库迁移完成
2025-04-17 20:20:26,776 - INFO - 开始迁移：添加is_admin字段
2025-04-17 20:20:26,779 - INFO - 添加is_admin字段到users表
2025-04-17 20:20:26,779 - INFO - 成功添加is_admin字段
2025-04-17 20:20:39,936 - INFO - 已将 clarencechl@hotmail.com 设置为管理员
2025-04-17 20:49:47,471 - INFO - 开始迁移：添加用户登录IP和时间字段
2025-04-17 20:49:47,474 - INFO - 需要添加last_login_ip字段
2025-04-17 20:49:47,475 - INFO - 需要添加last_login_time字段
2025-04-17 20:49:47,475 - INFO - 添加last_login_ip字段到users表
2025-04-17 20:49:47,476 - INFO - 成功添加last_login_ip字段
2025-04-17 20:49:47,476 - INFO - 添加last_login_time字段到users表
2025-04-17 20:49:47,477 - INFO - 成功添加last_login_time字段
2025-04-18 14:14:50,131 - INFO - === Starting migration: migrate_add_is_paid.py ===
2025-04-18 14:14:50,132 - INFO - Connected to database.
2025-04-18 14:14:50,133 - INFO - Adding column 'is_paid' to table 'users'...
2025-04-18 14:14:50,134 - INFO - Column 'is_paid' added successfully.
2025-04-18 14:14:50,134 - INFO - Changes committed.
2025-04-18 14:14:50,134 - INFO - Database connection closed.
2025-04-18 14:14:50,134 - INFO - === Finished migration: migrate_add_is_paid.py ===
2025-04-18 15:11:04,959 - INFO - === Starting migration: migrate_add_pdf_fields.py ===
2025-04-18 15:11:04,960 - INFO - Connected to database for PDF fields migration.
2025-04-18 15:11:04,961 - INFO - Adding column 'has_pdf' to table 'users'...
2025-04-18 15:11:04,962 - INFO - Column 'has_pdf' added successfully.
2025-04-18 15:11:04,962 - INFO - Adding column 'pdf_storage_path' to table 'users'...
2025-04-18 15:11:04,962 - INFO - Column 'pdf_storage_path' added successfully.
2025-04-18 15:11:04,962 - INFO - Changes committed for columns: has_pdf, pdf_storage_path.
2025-04-18 15:11:04,962 - INFO - Database connection closed after PDF fields migration.
2025-04-18 15:11:04,962 - INFO - === Finished migration: migrate_add_pdf_fields.py ===
2025-04-19 13:45:57,380 - INFO - === Starting migration: migrate_add_pdf_fields.py ===
2025-04-19 13:45:57,381 - INFO - Connected to database for PDF fields migration.
2025-04-19 13:45:57,382 - INFO - Column 'has_pdf' already exists.
2025-04-19 13:45:57,382 - INFO - Column 'pdf_storage_path' already exists.
2025-04-19 13:45:57,382 - INFO - No new columns were added. No commit needed.
2025-04-19 13:45:57,382 - INFO - Database connection closed after PDF fields migration.
2025-04-19 13:45:57,382 - INFO - === Finished migration: migrate_add_pdf_fields.py ===
2025-04-19 14:16:08,967 - INFO - 成功创建questionnaires表
2025-04-19 14:16:08,968 - INFO - 成功创建questionnaire_responses表
2025-04-19 14:16:08,968 - INFO - 迁移成功完成
2025-04-19 14:24:50,857 - INFO - questionnaires表已存在，跳过创建
2025-04-19 14:24:50,857 - INFO - questionnaire_responses表已存在，跳过创建
2025-04-19 14:24:50,857 - INFO - 迁移成功完成
